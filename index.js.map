{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '49376041-e249e8ece49f8c2dec7a331c4';\nconst BASE_URL = 'https://pixabay.com';\naxios.defaults.baseURL = BASE_URL;\n\nexport function fetchFromPixabay(query, page) {\n  return axios.get('/api/', {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: 15,\n      page,\n    },\n  });\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst refs = {\n  gallery: document.querySelector('.gallery'),\n};\n\nlet galleryView = new SimpleLightbox('a.gallery-link', {\n  captionDelay: 250,\n  captionsData: 'alt',\n});\n\nfunction createImageTemplate(image) {\n  const imageTags = image.tags.slice(0, 20 + image.tags.slice(20).indexOf(','));\n  return `<li class=\"gallery-item\">\n  <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n    <img\n      class=\"gallery-image\"\n      src=\"${image.webformatURL}\"\n      alt=\"${imageTags}\"\n    />\n    <ul class=\"info-list\">\n    <li class=\"photo-info\" data-likes>Likes<span>${image.likes}</span></li>\n    <li class=\"photo-info\" data-views>Views<span>${image.views}</span></li>\n    <li class=\"photo-info\" data-comments>Comments<span>${image.comments}</span></li>\n    <li class=\"photo-info\" data-downloads>Downloads<span>${image.downloads}</span></li>\n    </ul>\n  </a>\n</li>`;\n}\n\nexport function renderMoreGallery(images) {\n  const galeryContent = images.reduce(\n    (acc, image) => acc + createImageTemplate(image),\n    ''\n  );\n  refs.gallery.insertAdjacentHTML('beforeend', galeryContent);\n  galleryView.refresh();\n}\n\nexport function resetGallery() {\n  refs.gallery.innerHTML = '';\n  galleryView.refresh();\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { fetchFromPixabay } from './js/pixabay-api';\nimport { renderMoreGallery, resetGallery } from './js/render-functions';\n\nconst refs = {\n  form: document.querySelector('form'),\n  loader: document.querySelector('.loader'),\n  loadMoreBtn: document.querySelector('.load-more'),\n};\nrefs.form.addEventListener('submit', onSubmit);\nloaderStop();\n\nlet pageCount;\nlet query;\n\nasync function onSubmit(event) {\n  event.preventDefault();\n  const form = event.target;\n  hideLoadMoreBtn();\n  loaderStart();\n  if (!form.elements['search-text'].value.trim()) {\n    iziToast.show({\n      message: 'Please, enter something for us to look for',\n      title: 'Warning',\n      backgroundColor: 'yellow',\n      position: 'topRight',\n    });\n  } else {\n    try {\n      resetGallery();\n      query = form.elements['search-text'].value;\n      pageCount = 1;\n      const resalt = await fetchFromPixabay(query, pageCount);\n      const images = resalt.data.hits;\n\n      loaderStop();\n      if (images.length == 0) {\n        iziToast.error({\n          message: 'No resalt found',\n          position: 'topRight',\n        });\n      } else {\n        renderMoreGallery(images, pageCount);\n        if (resalt.data.totalHits > 15) {\n          showLoadMoreBtn();\n        }\n      }\n    } catch (error) {\n      console.log(error);\n    }\n    form.reset();\n  }\n}\n\nfunction showLoadMoreBtn() {\n  try {\n    refs.loadMoreBtn.classList.remove('visually-hidden');\n    refs.loadMoreBtn.addEventListener('click', onLoadMoreBtnClick);\n  } catch {\n    console.log('already shown');\n  }\n}\nfunction hideLoadMoreBtn() {\n  try {\n    refs.loadMoreBtn.removeEventListener(onLoadMoreBtnClick);\n    refs.loadMoreBtn.classList.add('visually-hidden');\n  } catch {\n    console.log('already removed');\n  }\n}\n\nasync function onLoadMoreBtnClick() {\n  pageCount++;\n  console.log(pageCount);\n  const resalt = await fetchFromPixabay(query, pageCount);\n  const images = resalt.data.hits;\n\n  renderMoreGallery(images);\n  refs.card = document.querySelector('.gallery-link');\n  const pixelsToScroll = refs.card.getBoundingClientRect().height * 2;\n\n  scrollBy({\n    top: pixelsToScroll,\n    behavior: 'smooth',\n  });\n\n  if (pageCount == Math.ceil(resalt.data.totalHits / 15)) {\n    iziToast.show({\n      message: \"We're sorry, but you've reached the end of search results.\",\n      position: 'topRight',\n      backgroundColor: 'yellow',\n    });\n    hideLoadMoreBtn();\n  }\n}\n\nfunction loaderStart() {\n  refs.loader.className = 'loader';\n}\nfunction loaderStop() {\n  refs.loader.className = '';\n}\n"],"names":["API_KEY","BASE_URL","axios","fetchFromPixabay","query","page","refs","galleryView","SimpleLightbox","createImageTemplate","image","imageTags","renderMoreGallery","images","galeryContent","acc","resetGallery","onSubmit","loaderStop","pageCount","event","form","hideLoadMoreBtn","loaderStart","iziToast","resalt","showLoadMoreBtn","error","onLoadMoreBtnClick","pixelsToScroll"],"mappings":"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"}